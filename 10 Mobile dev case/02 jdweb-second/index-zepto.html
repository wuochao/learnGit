<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"/>
    <title>jdweb-second</title>
    <link rel="stylesheet" href="css/base.css"/>
    <link rel="stylesheet" href="css/index.css"/>
</head>
<body>
<div class="jd-layout">
    <!--顶部搜索栏-->
    <header class="topbar">
        <a href="#" class="logo"></a>
        <form action="" class="searchBox">
            <input type="search" class="search" placeholder="提示信息" id=""/>
        </form>
        <a href="#" class="login">登录</a>
    </header>
    <!--轮播图-->
    <div class="jd-banner">
        <ul class="imgBox clearfix">
            <li><a href="#"><img src="uploads/l1.jpg" alt=""/></a></li>
            <li><a href="#"><img src="uploads/l2.jpg" alt=""/></a></li>
            <li><a href="#"><img src="uploads/l3.jpg" alt=""/></a></li>
            <li><a href="#"><img src="uploads/l4.jpg" alt=""/></a></li>
            <li><a href="#"><img src="uploads/l5.jpg" alt=""/></a></li>
            <li><a href="#"><img src="uploads/l6.jpg" alt=""/></a></li>
            <li><a href="#"><img src="uploads/l7.jpg" alt=""/></a></li>
            <li><a href="#"><img src="uploads/l8.jpg" alt=""/></a></li>
        </ul>
        <ol class="ol">
            <li class="active"></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
        </ol>
    </div>
    <!--导航-->
    <div class="jd-nav">
        <ul class="clearfix">
            <li>
                <a href="#">
                    <img src="uploads/nav0.png" alt=""/>
                    <p class="info">分类查询</p>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="uploads/nav1.png" alt=""/>
                    <p class="info">物流查询</p>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="uploads/nav2.png" alt=""/>
                    <p class="info">购物车</p>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="uploads/nav3.png" alt=""/>
                    <p class="info">我的京东</p>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="uploads/nav4.png" alt=""/>
                    <p class="info">充值</p>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="uploads/nav5.png" alt=""/>
                    <p class="info">领券中心</p>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="uploads/nav6.png" alt=""/>
                    <p class="info">京东超市</p>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="uploads/nav7.png" alt=""/>
                    <p class="info">我的关注</p>
                </a>
            </li>
        </ul>

    </div>
    <!--产品块-->
    <div class="jd-product">
        <div class="jd-productBox jd-seckill">
            <div class="jd-pHead">
                <span class="icon-clock fl m-left10"></span>
                <span class="sk fl m-left10">掌上秒杀</span>
                <div class="timerBack fl m-left10">
                    <span>0</span>
                    <span>0</span>
                    <span>:</span>
                    <span>0</span>
                    <span>0</span>
                    <span>:</span>
                    <span>0</span>
                    <span>0</span>
                </div>
                <a  href="#" class="more fr m-right10">更多秒杀...</a>
            </div>
            <div class="jd-pContent">
                <ul class="clearfix">
                    <li class="fl">
                        <a href="#"><img src="uploads/detail01.jpg" alt=""/></a>
                        <p class="new-price">&yen;10.00</p>
                        <p class="old-price">&yen;20.00</p>
                    </li>
                    <li class="fl">
                        <a href="#"><img src="uploads/detail01.jpg" alt=""/></a>
                        <p class="new-price">&yen;10.00</p>
                        <p class="old-price">&yen;20.00</p>
                    </li>
                    <li class="fl">
                        <a href="#"><img src="uploads/detail01.jpg" alt=""/></a>
                        <p class="new-price">&yen;10.00</p>
                        <p class="old-price">&yen;20.00</p>
                    </li>
                </ul>
            </div>
        </div>
        <div class="jd-productBox">
            <div class="jd-pHead">
                <h3>京东超市</h3>
            </div>
            <div class="jd-pContent clearfix">
                <a href="#" class="a-50 fl ">
                    <img src="uploads/cp1.jpg" alt=""/>
                </a>
                <a href="#" class="a-50 fl b-left b-bottom">
                    <img src="uploads/cp2.jpg" alt=""/>
                </a>
                <a href="#" class="a-50 fl b-left">
                    <img src="uploads/cp3.jpg" alt=""/>
                </a>
            </div>
        </div>
        <div class="jd-productBox">
            <div class="jd-pHead">
                <h3>京东超市</h3>
            </div>
            <div class="jd-pContent clearfix">
                <a href="#" class="a-50 fr ">
                    <img src="uploads/cp4.jpg" alt=""/>
                </a>
                <a href="#" class="a-50 fl b-right b-bottom">
                    <img src="uploads/cp5.jpg" alt=""/>
                </a>
                <a href="#" class="a-50 fl b-right">
                    <img src="uploads/cp6.jpg" alt=""/>
                </a>
            </div>
        </div>
        <div class="jd-productBox">
            <div class="jd-pHead">
                <h3>京东超市</h3>
            </div>
            <div class="jd-pContent clearfix">
                <a href="#" class="a-50 fl ">
                    <img src="uploads/cp1.jpg" alt=""/>
                </a>
                <a href="#" class="a-50 fl b-left b-bottom">
                    <img src="uploads/cp2.jpg" alt=""/>
                </a>
                <a href="#" class="a-50 fl b-left">
                    <img src="uploads/cp3.jpg" alt=""/>
                </a>
            </div>
        </div>
    </div>
</div>
<script src="js/zepto.min.js"></script>
<script>
    $(function(){
        //获取banner、imgBox、indicators在首尾添加最后1张、第1张图片实现无缝轮播的条件
        var banner = $('.jd-banner');
        var bannerWidth = banner.width();
        var imgBox = banner.find('ul:first-of-type');
        var indicators = banner.find('ol:first-of-type li');
        console.log(indicators);
        var firstImg = imgBox.find('li:first-of-type');
        var lastImg  = imgBox.find('li:last-of-type');
        imgBox.append(firstImg.clone());
        lastImg.clone().insertBefore(firstImg);

        //修改imgBox的宽度、imgBox每个li的宽度
        //先要获取imgBox下所有的li，根据li的个数 * 原始banner宽度 赋值给imgBox
        var lis = imgBox.children();
        var count = lis.length;
        //console.log(count);
        imgBox.width(count*bannerWidth);
        for(var i=0; i<lis.length; i++)
        {
            $(lis[i]).width(bannerWidth);
        }

        //设置默认偏移量
        imgBox.css('left',-bannerWidth);

        //设置图片指针，默认指向第1张图片，由于clone了首尾2张图片，索引号改变
        var imgIndex = 1;

        window.onresize = function(){
            bannerWidth = banner.width();
            imgBox.width(count*bannerWidth);
            for(var i=0; i<lis.length; i++)
            {
                $(lis[i]).width(bannerWidth);
            }
            imgBox.css('left',-imgIndex * bannerWidth);
        };

        //设置定时器，实现自动轮播
        var timer = null;
        autoplay();
        function autoplay()
        {
            clearInterval(timer);
            timer = setInterval(function(){
                imgIndex++;
                imgSlider();
            }, 1000);
        }
        function imgSlider()
        {
            imgBox.animate(
                    {'left': -imgIndex * bannerWidth},
                    200,
                    "ease-in-out",
                    function(){
                        //回调判断动画执行完后，要做的操作
                        if(imgIndex >= count-1)
                        {
                            imgIndex = 1;
                        }
                        else if(imgIndex <= 0)
                        {
                            imgIndex = count-2;
                        }
                        imgBox.css('left', -imgIndex*bannerWidth);
                        indicators.removeClass('active').eq(imgIndex-1).addClass('active');

                    }
            );
        }

        //手动轮播 swipeLeft、swipeRight 绑定左滑、右滑
        imgBox.on('swipeLeft', function(){
            clearInterval(timer);
            imgIndex++;
            imgSlider();
            autoplay();
        });

        imgBox.on('swipeRight', function(){
            clearInterval(timer);
            imgIndex--;
            imgSlider();
            autoplay();
        });

    });

</script>
</body>
</html>