<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"/>
    <title>jdweb-first</title>
    <link rel="stylesheet" href="css/base.css"/>
    <link rel="stylesheet" href="css/index.css"/>
</head>
<body>
<div class="jd-layout">
    <!--顶部搜索栏-->
    <header class="topbar">
        <a href="#" class="logo"></a>
        <form action="" class="searchBox">
            <input type="search" class="search" placeholder="信息"/>
        </form>
        <a href="#" class="login">登录</a>
    </header>
    <!--轮播图-->
    <div class="jd-banner">
        <ul class="imgBox clearfix">
            <li><a href="#"><img src="uploads/l1.jpg" alt=""/></a></li>
            <li><a href="#"><img src="uploads/l2.jpg" alt=""/></a></li>
            <li><a href="#"><img src="uploads/l3.jpg" alt=""/></a></li>
            <li><a href="#"><img src="uploads/l4.jpg" alt=""/></a></li>
            <li><a href="#"><img src="uploads/l5.jpg" alt=""/></a></li>
            <li><a href="#"><img src="uploads/l6.jpg" alt=""/></a></li>
            <li><a href="#"><img src="uploads/l7.jpg" alt=""/></a></li>
            <li><a href="#"><img src="uploads/l8.jpg" alt=""/></a></li>
        </ul>
        <ol class="indicator">
            <li class="active"></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
        </ol>
    </div>
    <!--导航栏-->
    <div class="jd-nav">
        <ul class="clearfix">
            <li>
                <a href="#">
                    <img src="uploads/nav0.png" alt=""/>
                    <p class="info">分类查询</p>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="uploads/nav1.png" alt=""/>
                    <p class="info">物流查询</p>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="uploads/nav2.png" alt=""/>
                    <p class="info">购物车</p>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="uploads/nav3.png" alt=""/>
                    <p class="info">我的京东</p>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="uploads/nav4.png" alt=""/>
                    <p class="info">充值</p>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="uploads/nav5.png" alt=""/>
                    <p class="info">领券中心</p>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="uploads/nav6.png" alt=""/>
                    <p class="info">京东超市</p>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="uploads/nav7.png" alt=""/>
                    <p class="info">我的关住</p>
                </a>
            </li>
        </ul>
    </div>
    <!--产品块-->
    <div class="jd-product">
        <div class="jd-productBox seckill">
            <div class="jd-pHead">
                <div class="f_left">
                    <span class="icon-clock  f_left m_left10"></span>
                    <span class="sk f_left m_left10">掌上秒杀</span>
                    <div class="timerBack f_left m_left10">
                        <span>0</span>
                        <span>0</span>
                        <span>:</span>
                        <span>0</span>
                        <span>0</span>
                        <span>:</span>
                        <span>0</span>
                        <span>0</span>
                    </div>
                </div>
                <div class="f_right m_right10"><a href="#">更多...</a></div>
            </div>
            <div class="jd-pContent clearfix">
                <ul class="clearfix">
                    <li class="f_left ">
                        <a href="#">
                            <img src="uploads/detail01.jpg" alt=""/>
                        </a>
                        <p class="new-price">&yen;10.00</p>
                        <p class="old-price">&yen;20.00</p>
                    </li>
                    <li class="f_left ">
                        <a href="#">
                            <img src="uploads/detail01.jpg" alt=""/>
                        </a>
                        <p class="new-price">&yen;10.00</p>
                        <p class="old-price">&yen;20.00</p>
                    </li>
                    <li class="f_left ">
                        <a href="#">
                            <img src="uploads/detail01.jpg" alt=""/>
                        </a>
                        <p class="new-price">&yen;10.00</p>
                        <p class="old-price">&yen;20.00</p>
                    </li>
                </ul>
            </div>
        </div>
        <div class="jd-productBox">
            <div class="jd-pHead">
                <h3>京东超市</h3>
            </div>
            <div class="jd-pContent clearfix">
                <a href="#" class="f_left a-50">
                    <img src="uploads/cp1.jpg" alt=""/>
                </a>
                <a href="#" class="f_left a-50 b-left b-bottom">
                    <img src="uploads/cp2.jpg" alt=""/>
                </a>
                <a href="#" class="f_left a-50 b-left">
                    <img src="uploads/cp3.jpg" alt=""/>
                </a>
            </div>
        </div>
        <div class="jd-productBox">
            <div class="jd-pHead">
                <h3>京东超市</h3>
            </div>
            <div class="jd-pContent clearfix">
                <a href="#" class="f_right a-50">
                    <img src="uploads/cp4.jpg" alt=""/>
                </a>
                <a href="#" class="f_left a-50 b-right b-bottom">
                    <img src="uploads/cp5.jpg" alt=""/>
                </a>
                <a href="#" class="f_left a-50 b-right">
                    <img src="uploads/cp6.jpg" alt=""/>
                </a>
            </div>
        </div>
        <div class="jd-productBox">
            <div class="jd-pHead">
                <h3>京东超市</h3>
            </div>
            <div class="jd-pContent clearfix">
                <a href="#" class="f_left a-50">
                    <img src="uploads/cp1.jpg" alt=""/>
                </a>
                <a href="#" class="f_left a-50 b-left b-bottom">
                    <img src="uploads/cp2.jpg" alt=""/>
                </a>
                <a href="#" class="f_left a-50 b-left">
                    <img src="uploads/cp3.jpg" alt=""/>
                </a>
            </div>
        </div>
    </div>
</div>
<script src="js/zepto.min.js"></script>
<script>
    // 使用zepto实现轮播图： 自动轮播 + 手动轮播
    /*1.添加首尾两张图片*/
    /*2.重新设置图片盒子和宽度和图片的宽度*/
    /*3.开启定时器，实现自动轮播*/
    /*4.添加移动端的滑动事件，实现手动轮播*/
    /*5.添加过渡效果结束之后的监听*/

    $(function(){
        //用zepto实现轮播图：自动轮播+手动轮播
        var banner = $('.jd-banner');
        var bannerWidth = banner.width();
        var imgBox = $('.imgBox');
        var indicators = $('.indicator').find('li');
        //console.log(indicators)
        //动态创建第一个和最后一个元素添加到首尾 克隆标签的方法clone()
        var firstImg = imgBox.find('li:first-of-type ');
        var lastImg  = imgBox.find('li:last-of-type ');
        imgBox.append(firstImg.clone());
        lastImg.clone().insertBefore(firstImg);
        //动态设置宽度 width(count*bannerWidth) lis.width(bannerWidth)
        var lis = imgBox.find('li');
        var count = lis.length;
        imgBox.width(count*bannerWidth);
        //可以给所有li元素都设置这个宽度
        for(var i=0; i<lis.length; i++)
        {
            $(lis[i]).width(bannerWidth);
        }
        //设置默认偏移
        imgBox.css("left", -bannerWidth);
        //封装自动轮播函数，设置自动轮播的定时器
        var timer = null;
        //图片指针imgIndex，默认指向第1张图片，索引为1，原本应该是0，但是由于为了实现无缝轮播，首位各插入1张图片，改变索引号
        var imgIndex = 1;
        function autoplay()
        {
            clearInterval(timer);
            timer = setInterval(function(){
                imgIndex++;
                //直接使用animate函数实现过渡效果，和图片imgBox滑动
                slider(imgIndex);
            }, 1000);
        }
        function slider()
        {
            imgBox.animate(
                    {"left":-imgIndex*bannerWidth},
                    500,
                    "ease-in-out",
                    function(){

                        if(imgIndex >= count-1)
                            imgIndex = 1;
                        else if(imgIndex <= 0)
                            imgIndex = count-2;
                        imgBox.css("left", -imgIndex*bannerWidth);
                        //实现小圆点的切换
                        indicators.removeClass('active').eq(imgIndex-1).addClass('active');
                    });
        }
        autoplay();

        //屏幕改变时window.onresize事件
        window.onresize = function(){
            bannerWidth = banner.width();
            imgBox.width(count*bannerWidth);
            for(var i=0; i<lis.length; i++)
            {
                $(lis[i]).width(bannerWidth);
            }
            imgBox.css('left',-imgIndex * bannerWidth);
        }

        //实现手动轮播：zepto自带了滑动的事件 swipeLeft （从右往左滑动） swipeRight (从左往右滑)
        //swipeLeft  切换到下一张 index++ 调用动画，注意要清除自动轮播的定时器
        //swipeRight 切换到上一张 index-- 调用动画，注意要清除自动轮播的定时器
        //在谷歌浏览器的模拟器中，无法正确的触发swipe相关事件，但是可以触发tap事件
        imgBox.on('swipeLeft',function(){
            clearInterval(timer);
            imgIndex++;
            slider();
            autoplay();
        });
        imgBox.on('swipeRight',function(){
            clearInterval(timer);
            imgIndex--;
            slider();
            autoplay();
        });
    });



</script>
</body>
</html>